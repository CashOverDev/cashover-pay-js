<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout - Premium Plan</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #000000 0%, #232223 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .checkout-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        overflow: hidden;
        display: grid;
        grid-template-columns: 1fr 400px;
        min-height: 600px;
      }

      .order-summary {
        background: #f8fafc;
        padding: 40px 32px;
        border-right: 1px solid #e2e8f0;
      }

      .order-summary h2 {
        font-size: 18px;
        font-weight: 600;
        color: #1a202c;
        margin-bottom: 24px;
      }

      .product-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 0;
        border-bottom: 1px solid #e2e8f0;
      }

      .product-details h3 {
        font-size: 16px;
        font-weight: 500;
        color: #2d3748;
        margin-bottom: 4px;
      }

      .product-details p {
        font-size: 14px;
        color: #718096;
      }

      .product-price {
        font-size: 16px;
        font-weight: 600;
        color: #2d3748;
      }

      .order-total {
        padding-top: 24px;
        margin-top: 16px;
        border-top: 2px solid #e2e8f0;
      }

      .total-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
      }

      .total-row.final {
        font-size: 18px;
        font-weight: 700;
        color: #1a202c;
        padding-top: 8px;
        border-top: 1px solid #cbd5e0;
      }

      .checkout-form {
        padding: 40px 32px;
      }

      .form-header {
        margin-bottom: 32px;
      }

      .form-header h1 {
        font-size: 24px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 8px;
      }

      .form-header p {
        color: #718096;
        font-size: 16px;
      }

      .payment-method {
        flex: 1;
        padding: 16px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s ease;
        background: white;
      }

      .payment-method:hover {
        border-color: #000000;
        background: #f9f9f9;
      }

      .payment-method.active {
        border-color: #000000;
        background: #f9f9f9;
        box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
      }

      .payment-method span {
        font-size: 14px;
        font-weight: 500;
        color: #2d3748;
      }

      .form-group {
        margin-bottom: 24px;
      }

      .form-row {
        display: flex;
        gap: 16px;
      }

      .form-row .form-group {
        flex: 1;
      }

      label {
        display: block;
        font-size: 14px;
        font-weight: 500;
        color: #374151;
        margin-bottom: 8px;
      }

      input,
      select {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.2s ease;
        background: white;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: #000000;
        box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
      }

      input.error {
        border-color: #ef4444;
        box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
      }

      .error-message {
        color: #ef4444;
        font-size: 12px;
        margin-top: 4px;
        display: none;
      }

      .card-icons {
        display: flex;
        gap: 8px;
        margin-top: 8px;
      }

      .card-icon {
        width: 32px;
        height: 20px;
        background: #f3f4f6;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: bold;
        color: #6b7280;
      }

      .security-info {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 24px 0;
        padding: 12px;
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        border-radius: 8px;
      }

      .security-icon {
        color: #16a34a;
      }

      .security-text {
        font-size: 14px;
        color: #166534;
      }

      .pay-button {
        width: 100%;
        padding: 12px 24px;
        background-color: #000000;
        color: #ffffff;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-top: 16px;
        position: relative;
        overflow: hidden;
      }

      .pay-button:hover {
        background-color: #1a1a1a;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      .pay-button:active {
        transform: translateY(0);
      }

      .pay-button.loading {
        opacity: 0.7;
        cursor: not-allowed;
      }

      .loading-spinner {
        display: none;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
        margin-right: 8px;
      }

      .pay-button.loading .loading-spinner {
        display: inline-block;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .terms {
        font-size: 12px;
        color: #9ca3af;
        text-align: center;
        margin-top: 16px;
        line-height: 1.5;
      }

      .terms a {
        color: #000000;
        text-decoration: none;
      }

      .terms a:hover {
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        .checkout-container {
          grid-template-columns: 1fr;
          max-width: 500px;
        }

        .order-summary {
          border-right: none;
          border-bottom: 1px solid #e2e8f0;
          padding: 24px 20px;
        }

        .checkout-form {
          padding: 24px 20px;
        }

        .form-row {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="checkout-container">
      <div class="order-summary">
        <h2>Order Summary</h2>

        <div class="product-item">
          <div class="product-details">
            <h3>Premium Plan</h3>
            <p>Monthly subscription</p>
          </div>
          <div class="product-price">$29.99</div>
        </div>

        <div class="product-item">
          <div class="product-details">
            <h3>Setup Fee</h3>
            <p>One-time charge</p>
          </div>
          <div class="product-price">$9.99</div>
        </div>

        <div class="order-total">
          <div class="total-row">
            <span>Subtotal</span>
            <span>$39.98</span>
          </div>
          <div class="total-row">
            <span>Tax</span>
            <span>$3.20</span>
          </div>
          <div class="total-row final">
            <span>Total</span>
            <span>$43.18</span>
          </div>
        </div>
      </div>

      <div class="checkout-form">
        <div class="form-header">
          <h1>Complete your purchase</h1>
          <p>Enter your payment details below</p>
        </div>

        <form id="checkout-form">
          <div class="form-group">
            <label for="email">Email address</label>
            <input type="email" id="email" name="email" required />
            <div class="error-message">Please enter a valid email address</div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="country">Country</label>
              <select id="country" name="country" required>
                <option value="">Select country</option>
                <option value="US">United States</option>
                <option value="CA">Canada</option>
                <option value="GB">United Kingdom</option>
                <option value="FR">France</option>
                <option value="DE">Germany</option>
                <option value="AU">Australia</option>
              </select>
              <div class="error-message">Please select a country</div>
            </div>
            <div class="form-group">
              <label for="postal-code">Postal code</label>
              <input type="text" id="postal-code" name="postal-code" required />
              <div class="error-message">Please enter a postal code</div>
            </div>
          </div>

          <!-- Include the CashOver Pay SDK -->
          <script
            src="https://cdn.cashover.money/js-sdk/latest/cashover.js"
            integrity="sha384-ZswI/MwwgvCyrUbBY/+7DW1yyUfqHDIdfQT8n+CaRB5IWTFrNBYXXrAMSRLYqSSW"
            crossorigin="anonymous"
          ></script>

          <div
            style="display: flex; justify-content: center; align-items: center"
          >
            <cashover-pay-button
              merchantUsername="drop.market"
              storeUsername="al.beik"
              amount="43.18"
              currency="USD"
              webhookIds='["id1", "id2"]'
              metadata='{"orderId":"A1001", "email":"testEmail@mail.com", "country":"", "postalCode":"1"}'
              language="en"
              theme="light"
              borderRadius="8px"
            >
            </cashover-pay-button>
          </div>

          <div class="terms">
            By completing your purchase, you agree to our
            <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.
          </div>
        </form>
      </div>
    </div>

    <script>
      // Payment method selection (single method now)
      document.querySelectorAll(".payment-method").forEach((method) => {
        method.addEventListener("click", function () {
          document
            .querySelectorAll(".payment-method")
            .forEach((m) => m.classList.remove("active"));
          this.classList.add("active");
        });
      });

      // Form validation
      function validateField(field) {
        const value = field.value.trim();
        const errorElement = field.parentNode.querySelector(".error-message");
        let isValid = true;

        switch (field.type) {
          case "email":
            isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
            break;
          case "select-one":
            isValid = value !== "";
            break;
          default:
            isValid = value.length > 0;
        }

        if (isValid) {
          field.classList.remove("error");
          errorElement.style.display = "none";
        } else {
          field.classList.add("error");
          errorElement.style.display = "block";
        }

        return isValid;
      }

      // Real-time validation
      document.querySelectorAll("input, select").forEach((field) => {
        field.addEventListener("blur", () => validateField(field));
      });

      // Update CashOver metadata when form fields change
      function updateCashOverMetadata() {
        const button = document.querySelector("cashover-pay-button");
        const email = document.getElementById("email").value;
        const country = document.getElementById("country").value;
        const postalCode = document.getElementById("postal-code").value;

        if (button) {
          const metadata = {
            orderId: "A1001",
            email: email,
            country: country,
            postalCode: postalCode,
          };
          button.setAttribute("metadata", JSON.stringify(metadata));
        }
      }

      // Listen for form changes to update metadata
      document.addEventListener("input", updateCashOverMetadata);
      document.addEventListener("change", updateCashOverMetadata);

      // Form submission validation
      document
        .getElementById("checkout-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const fields = this.querySelectorAll("input, select");
          let allValid = true;

          fields.forEach((field) => {
            if (!validateField(field)) {
              allValid = false;
            }
          });

          if (allValid) {
            updateCashOverMetadata();
            // The CashOver button will handle the payment process
            alert(
              "Form validated successfully! Please proceed with CashOver payment."
            );
          }
        });

      // Initialize CashOver when available
      document.addEventListener("DOMContentLoaded", function () {
        console.log(
          "CashOver Button Ready:",
          document.querySelector("cashover-pay-button")
        );
      });
    </script>
  </body>
</html>
